language: go

sudo: required

dist: trusty

install:
  - curl -LO https://github.com/gohugoio/hugo/releases/download/v0.46/hugo_0.46_Linux-64bit.deb && sudo dpkg -i *.deb && rm *.deb
  - curl -LO https://github.com/netlify/netlifyctl/releases/download/v0.4.0/netlifyctl-linux-amd64-0.4.0.tar.gz && tar -xzvf *.tar.gz && mv netlifyctl /usr/local/bin && rm *.tar.gz
  
before_script:
  - hugo version
  - netlifyctl version

script:
  - cd exampleSite && hugo -v --themesDir ../../ && cd ..
  - mv exampleSite/public .

after_success:
  - netlifyctl deploy -A $NETLIFY_ACCESS_TOKEN -m "$TRAVIS_COMMIT_MESSAGE" $([[ $TRAVIS_BRANCH = "master" ]] && echo "" || echo "-d")
